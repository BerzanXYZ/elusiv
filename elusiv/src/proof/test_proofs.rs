use crate::{types::{Proof, U256}, fields::u256_from_str_skip_mr};

use super::proof_from_str_projective;

pub struct TestProof {
    pub proof: Proof,
    pub public_inputs: Vec<U256>,
}

impl TestProof {
    pub fn new(proof: Proof, public_inputs: &[&str]) -> Self {
        TestProof {
            proof,
            public_inputs: public_inputs.iter()
                .map(|x| u256_from_str_skip_mr(x))
                .collect(),
        }
    }
}

/// Note: uses the `TestVKey`
pub fn valid_proofs() -> Vec<TestProof> {
    vec![
        TestProof::new(
            proof_from_str_projective(
                (
                    "939406440341138700300173474156819099994415890337704148673539858231420938136",
                    "2596686398470431370069288576509933738637451711940877825742531414910045587268",
                    "1",
                ),
                (
                    (
                        "314787956326705763598148823266705109299358413773132112525755155205866892976",
                        "10265282316379762160948487869770807327157877422443807529334747929561355462381",
                    ),
                    (
                        "15718308175018605755819080945755829198826727629273758998498152432334839399761",
                        "13749081164531951325226940558243955065188916376107904434149498532050066990373",
                    ),
                    (
                        "1",
                        "0",
                    ),
                ),
                (
                    "7325639407663748084883151761611673599102545916848648303300781936062962834946",
                    "9654674193699696579998078979854477309353457754973475489046853693464866840653",
                    "1",
                ),
            ),
            &[
                "7889586699914970744657798935358222218486353295005298675075639741334684257960",
                "9606705614694883961284553030253534686862979817135488577431113592919470999200",
                "3274987707755874055218761963679216380632837922347165546870932041376197622893",
                "0",
                "2314301174895263184787527304375041393711603277357154686958639354085712014171",
                "2314301174895263184787527304375041393711603277357154686958639354085712014171",
                "2314301174895263184787527304375041393711603277357154686958639354085712014171",
                "0",
                "340282366920938463463374607431768211455",
                "340282366920938463463374607431768211455",
                "179000",
                "1657877510",
                "1",
                "2",
                "13567912234980578078208542712651823885575897584219352304359819680190779617998",
                "0",
            ]
        ),
        TestProof::new(
            proof_from_str_projective(
                (
                    "10016476495972136269606331374798538526801423134269299612731351181043498586614",
                    "19943099156707912655311095217279910156113835108560296875999058710947018960226",
                    "1",
                ),
                (
                    (
                        "18967660067005655783589675432977177149237714426981078441928114223331686874617",
                        "15822399048756725949023827924870583757991104166966011749922326082073237215176",
                    ),
                    (
                        "17371403479998703087714369921815727369367047650730168956314726853879295877039",
                        "1905452767445489421401174444579339951901391289120618191618339705760406913472",
                    ),
                    (
                        "1",
                        "0",
                    ),
                ),
                (
                    "3575378876962201793701203007860609279910003703090806676863683315792077669530",
                    "3361483683684509944118372471164858507337610962362597044533832285149827612707",
                    "1",
                ),
            ),
            &[
                "7889586699914970744657798935358222218486353295005298675075639741334684257960",
                "0",
                "0",
                "0",
                "18598816241593230356331487756723282739524869644352183697053396758017591994053",
                "0",
                "0",
                "0",
                "340282366920938463463374607431768211455",
                "340282366920938463463374607431768211455",
                "50000",
                "1657877885",
                "1",
                "2",
                "3716521134968974343541069916787339801669960754036988500494814263746849417157",
                "0",
            ]
        ),
    ]
}

pub fn invalid_proofs() -> Vec<TestProof> {
    vec![
        // Changed timestamp
        TestProof::new(
            proof_from_str_projective(
                (
                    "939406440341138700300173474156819099994415890337704148673539858231420938136",
                    "2596686398470431370069288576509933738637451711940877825742531414910045587268",
                    "1",
                ),
                (
                    (
                        "314787956326705763598148823266705109299358413773132112525755155205866892976",
                        "10265282316379762160948487869770807327157877422443807529334747929561355462381",
                    ),
                    (
                        "15718308175018605755819080945755829198826727629273758998498152432334839399761",
                        "13749081164531951325226940558243955065188916376107904434149498532050066990373",
                    ),
                    (
                        "1",
                        "0",
                    ),
                ),
                (
                    "7325639407663748084883151761611673599102545916848648303300781936062962834946",
                    "9654674193699696579998078979854477309353457754973475489046853693464866840653",
                    "1",
                ),
            ),
            &[
                "7889586699914970744657798935358222218486353295005298675075639741334684257960",
                "9606705614694883961284553030253534686862979817135488577431113592919470999200",
                "3274987707755874055218761963679216380632837922347165546870932041376197622893",
                "0",
                "2314301174895263184787527304375041393711603277357154686958639354085712014171",
                "2314301174895263184787527304375041393711603277357154686958639354085712014171",
                "2314301174895263184787527304375041393711603277357154686958639354085712014171",
                "0",
                "340282366920938463463374607431768211455",
                "340282366920938463463374607431768211455",
                "179000",
                "1657877511",
                "1",
                "2",
                "13567912234980578078208542712651823885575897584219352304359819680190779617998",
                "0",
            ]
        ),

        // Changed proof a.x by one bit
        TestProof::new(
            proof_from_str_projective(
                (
                    "939406440341138700300173474156819099994415890337704148673539858231420938137",
                    "2596686398470431370069288576509933738637451711940877825742531414910045587268",
                    "1",
                ),
                (
                    (
                        "314787956326705763598148823266705109299358413773132112525755155205866892976",
                        "10265282316379762160948487869770807327157877422443807529334747929561355462381",
                    ),
                    (
                        "15718308175018605755819080945755829198826727629273758998498152432334839399761",
                        "13749081164531951325226940558243955065188916376107904434149498532050066990373",
                    ),
                    (
                        "1",
                        "0",
                    ),
                ),
                (
                    "7325639407663748084883151761611673599102545916848648303300781936062962834946",
                    "9654674193699696579998078979854477309353457754973475489046853693464866840653",
                    "1",
                ),
            ),
            &[
                "7889586699914970744657798935358222218486353295005298675075639741334684257960",
                "9606705614694883961284553030253534686862979817135488577431113592919470999200",
                "3274987707755874055218761963679216380632837922347165546870932041376197622893",
                "0",
                "2314301174895263184787527304375041393711603277357154686958639354085712014171",
                "2314301174895263184787527304375041393711603277357154686958639354085712014171",
                "2314301174895263184787527304375041393711603277357154686958639354085712014171",
                "0",
                "340282366920938463463374607431768211455",
                "340282366920938463463374607431768211455",
                "179000",
                "1657877510",
                "1",
                "2",
                "13567912234980578078208542712651823885575897584219352304359819680190779617998",
                "0",
            ]
        ),
    ]
}